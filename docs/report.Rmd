---
title: "Healthcare Costs Associated with Musculoskeletal Disorders in Adults with Type 2 Diabetes (MEPS)"
author: "Taiwo Adesoba, PhD"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)

library(tidyverse)
library(knitr)

## Background

Musculoskeletal disorders (MSD) are common comorbidities among adults with type 2 diabetes (T2D). These conditions contribute to pain, reduced mobility, diminished quality of life, and increased healthcare resource utilization. Understanding the incremental economic burden of MSD in patients with T2D can inform value assessments, HEOR modeling, and payer decision-making.

This analysis uses publicly available data from the Medical Expenditure Panel Survey (MEPS) to estimate:

- Differences in demographic and clinical characteristics between adults with T2D with vs without MSD  
- Differences in annual healthcare costs  
- Incremental expenditures associated with MSD using GLM-based cost models  

## Methods

### Data Source
We used the 2016 Full-Year Consolidated file from the Medical Expenditure Panel Survey (MEPS) and derived an analytic dataset (`t2dstudy16.csv`) containing adults with type 2 diabetes (T2D), musculoskeletal disorder (MSD) status, and person-level sampling weights.

All analyses use MEPS-provided person-level sampling weights (`wght`), strata (`VARSTR`), and primary sampling units (`VARPSU`) to obtain nationally representative estimates.

### Study Population
- Adults aged ≥18 years
- Individuals with type 2 diabetes (T2D)
- Subgroups defined by presence/absence of musculoskeletal disorders (MSD), using the `msdx` indicator

### Outcomes
- Annual total healthcare expenditures (`total_exp`, derived from `exp_tot2`)
- Demographic and clinical characteristics
- Incremental expenditures associated with MSD

### Statistical Analyses
- Survey-weighted descriptive statistics
- Survey-weighted prevalence of MSD
- Propensity-score–based inverse probability of treatment weighting (IPTW) for the average treatment effect on the treated (ATT), using `msdx` as exposure and key covariates (age, sex, ethnicity, insurance, income, employment, marital status, region, BMI)
- Two-part cost model:
  - Part 1: survey-weighted logistic regression for any expenditure
  - Part 2: survey-weighted Gamma log-link model for positive expenditures
- Marginal expected annual costs by MSD status combining Parts 1 and 2

All code used for the analysis is located in the `R/` folder of this repository.

## Load Cohort

meps_cohort <- readRDS("../data/derived/meps_t2d_msd_cohort_2016.rds")
head(meps_cohort)

## Table 1: Baseline Characteristics

tab1 <- readr::read_csv("../output/tables/table1_msdx_baseline.csv")
knitr::kable(
  tab1,
  caption = "Table 1. Baseline characteristics of adults with T2D, stratified by MSD status",
  format = "html"
)

## Two-part Model Marginal Effects

me_msd <- readr::read_csv("../output/tables/two_part_marginal_effects.csv")
knitr::kable(
  me_msd,
  caption = "Table 2. Expected annual healthcare expenditures by MSD status (two-part ATT-IPTW model)",
  format = "html"
)

## Conclusions

## Conclusions

In this MEPS 2016–based analysis of adults with type 2 diabetes, those with musculoskeletal disorders had **\$6,450 higher expected annual healthcare costs**, corresponding to approximately **64% higher expenditures**, compared with those without MSD, after survey-weighted ATT-IPTW adjustment using a two-part model.

These findings highlight the substantial incremental economic burden of MSD among patients with T2D and demonstrate a reproducible HEOR workflow including cohort derivation, survey-weighted descriptive analyses, propensity-score weighting, two-part cost modeling, and automated reporting in R.
